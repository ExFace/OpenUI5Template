/*
 * ! OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge"],function(m){"use strict";function f(r){var v={};r.some(function(R){if(R.variantSection&&Object.keys(R.variantSection).length>0){v=R.variantSection;return true;}});return v;}function c(){return{variantManagementChanges:{},variants:[]};}function a(v,V){var r=v[V];if(!r){r=s._createStandardVariant(V);v[V]=r;}return r;}function g(r){if(!r){return[];}return r.controlChanges.map(function(C){return C;});}function b(v,V){var p=m({},v);V.forEach(function(q){var r=q.variantReference;var R;if(r){R=a(p,r);}p[q.fileName]={content:q,controlChanges:g(R),variantChanges:{}};});return p;}function d(v,V){var p=m({},v);V.forEach(function(C){p[C.variantReference]=p[C.variantReference]||s._createStandardVariant(C.variantReference);p[C.variantReference].controlChanges.push(C);});return p;}function e(v,V){var p=m({},v);V.forEach(function(C){p[C.selector.id]=p[C.selector.id]||s._createStandardVariant(C.selector.id);var q=p[C.selector.id].variantChanges[C.changeType]||[];q.push(C);p[C.selector.id].variantChanges[C.changeType]=q;});return p;}function h(r,v){var R=m({},r);Object.keys(v).forEach(function(V){var p=v[V];var q=p.content.variantManagementReference;if(!R.variantSection[q]){R.variantSection[q]=c();}R.variantSection[q].variants.push(p);});return R;}function i(r,v){var R=m({},r);v.forEach(function(C){var V=C.selector.id;if(!R.variantSection[V]){R.variantSection[V]=c();}var p=C.changeType;if(!R.variantSection[V].variantManagementChanges[p]){R.variantSection[V].variantManagementChanges[p]=[];}R.variantSection[V].variantManagementChanges[p].push(C);});return R;}function j(r){var R=m({},r);Object.keys(R.variantSection).forEach(function(v){var V=R.variantSection[v];var S=V.variants.findIndex(function(q){return q.content.fileName===v;});var p;if(S===-1){p=s._createStandardVariant(v);}else{p=V.variants[S];V.variants.splice(S,1);}V.variants.unshift(p);});return R;}function k(r){var v=[];r.forEach(function(R){v=v.concat(R.variantManagementChanges);});return v;}function l(r){var v={};r.forEach(function(R){v=b(v,R.variants);v=d(v,R.variantDependentControlChanges);v=e(v,R.variantChanges);});return v;}function n(r,v,V){r=h(r,v);r=i(r,V);r=j(r);return r;}var s={};function _(r){var C=[];r.forEach(function(R){C=C.concat(R.changes);});var p=[];C=C.filter(function(q){var F=q.fileName;var t=p.indexOf(F)!==-1;if(t){return false;}p.push(F);return true;});return C;}function o(r){return r.reduce(function(u,R){return m({},u,R.ui2personalization);},{});}s.merge=function(p){var r={changes:_(p.responses),ui2personalization:o(p.responses),variantSection:{}};if(p.variantSectionSufficient){r.variantSection=f(p.responses);}else{var v=l(p.responses);var V=k(p.responses);r=n(r,v,V);}return r;};s._createStandardVariant=function(v){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.fl");return{content:{fileName:v,variantManagementReference:v,content:{title:r.getText("STANDARD_VARIANT_TITLE")},favorite:true,visible:true},variantChanges:{},controlChanges:[]};};return s;});
